<!DOCTYPE html>
<html>
<head>
    <title>Hover Display Text</title>
    <style>
        .tooltip {
            position: fixed;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0s linear 0.3s; /* Delay visibility change */
            max-width: 400px; /* Maximum width of the tooltip */
            max-height: 300px; /* Maximum height of the tooltip */
            overflow: auto; /* Add scroll to the tooltip */
        }
    </style>
</head>
<body>
    <div>
        {% for item in items %}
            {% with full_text="This is the concatenated text with the full content: " %}
                <span
                    class="truncated-text"
                    onmouseover="showFullText(event, this, '{{ item.text|safe }}')"
                    onmouseout="hideFullText()"
                >
                    {{ full_text|safe }}{{ item.text|truncatechars:50 }}
                </span>
                <div class="hidden-content" style="display: none;">{{ item.text|safe }}</div>
            {% endwith %}
        {% endfor %}
    </div>

    <!-- JavaScript code -->
    <script>
        var tooltip = document.createElement("div");
        tooltip.classList.add("tooltip");
        document.body.appendChild(tooltip);

        var textarea = document.createElement("textarea");
        textarea.classList.add("hidden-textarea");
        document.body.appendChild(textarea);

        function showFullText(event, element, text) {
            // Calculate the position of the truncated text relative to the viewport
            var textRect = element.getBoundingClientRect();
            var textPositionTop = textRect.top + window.pageYOffset;
            var textPositionLeft = textRect.left + window.pageXOffset;

            // Set the position of the tooltip
            tooltip.style.top = textPositionTop - tooltip.offsetHeight - 10 + "px";
            tooltip.style.left = textPositionLeft + textRect.width / 2 - tooltip.offsetWidth / 2 + "px";

            // Set the value of the hidden textarea with the full text content
            textarea.value = stripHTMLTags(text);

            // Display the content of the textarea inside the tooltip
            tooltip.textContent = textarea.value;

            tooltip.style.visibility = "visible"; // Make tooltip visible immediately
            tooltip.style.opacity = "1"; // Fade-in effect
        }

        function stripHTMLTags(html) {
            var tmp = document.createElement("div");
            tmp.innerHTML = html;
            return tmp.textContent || tmp.innerText || "";
        }

        function hideFullText() {
            tooltip.style.opacity = "0"; // Fade-out effect
            tooltip.style.visibility = "hidden"; // Hide after fade-out
        }
    </script>
</body>
</html>
