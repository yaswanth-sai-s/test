<select id="region">
    <option value="">Select a country</option>
    <option value="country1">Country 1</option>
    <option value="country2">Country 2</option>
    <!-- Add more country options here -->
</select>

<select id="regionalDropdown" multiple>
    <option value="">Select a region</option>
</select>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
    // Function to handle the dynamic behavior of the second dropdown
    function updateRegionalDropdown(selectedCountries) {
        $.ajax({
            url: "{% url 'get_regional_code' %}",
            data: { 'countries': selectedCountries },
            dataType: 'json',
            success: function(data) {
                // Clear the second dropdown options
                $("#regionalDropdown").empty();
                // Add the new options based on the received data
                $.each(data.regional_code, function(index, value) {
                    $("#regionalDropdown").append('<option value="' + value + '">' + value + '</option>');
                });
            },
            error: function(error) {
                console.log("Error:", error);
            }
        });
    }

    $(document).ready(function() {
        // Function to handle the change in the first dropdown
        $("#region").change(function() {
            var selectedCountries = $(this).val();
            updateRegionalDropdown(selectedCountries);
        });
    });
</script>


v2:

<script>
    $(document).ready(function() {
        $(".selectpicker").selectpicker();

        // ... Other code ...

        // Define the full list of regional codes
        var allRegionalCodes = [];

        // Populate the initial regional codes (replace with actual data)
        $.ajax({
            url: "/get_all_regional_codes/",  // Replace with your URL
            success: function(data) {
                allRegionalCodes = data.regional_codes;
            },
            error: function(error) {
                console.log("Error fetching all regional codes:", error);
            }
        });

        // Function to update the regional dropdown based on selected countries
        function updateRegionalDropdown(selectedCountries) {
            $.ajax({
                url: "/get_regional_code/",
                data: { 'countries': selectedCountries },
                dataType: 'json',
                success: function(data) {
                    var regionalDropdown = $("#regionalDropdown");
                    regionalDropdown.empty();

                    $.each(data.regional_code, function(index, value) {
                        regionalDropdown.append($('<option>', {
                            value: value,
                            text: value
                        }));
                    });

                    regionalDropdown.selectpicker('refresh');
                },
                error: function(error) {
                    console.log("Error:", error);
                }
            });
        }

        // Update the regional dropdown when countries are selected
        $("#region").change(function() {
            var selectedCountries = $(this).val();
            updateRegionalDropdown(selectedCountries);
        });

        // Update the regional dropdown on page load (if needed)
        var selectedCountries = $("#region").val();
        updateRegionalDropdown(selectedCountries);

        // Function to send selected regional codes to the server
        $("#regionalDropdown").change(function() {
            var selectedRegionalCodes = $(this).val();
            $.ajax({
                url: "/handle_regions/",  // Replace with your URL
                data: { 'selected_regions': selectedRegionalCodes },
                type: 'GET',
                success: function(response) {
                    console.log("Selected Regional Codes sent to server:", selectedRegionalCodes);
                },
                error: function(error) {
                    console.log("Error sending selected regions:", error);
                }
            });
        });
    });
</script>
